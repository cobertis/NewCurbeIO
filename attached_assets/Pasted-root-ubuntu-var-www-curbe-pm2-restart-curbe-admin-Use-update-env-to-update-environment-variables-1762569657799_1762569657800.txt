root@ubuntu:/var/www/curbe# pm2 restart curbe-admin
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [curbe-admin](ids: [ 0 ])
[PM2] [curbe-admin](0) âœ“
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name           â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ mem      â”‚ user     â”‚ watching â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ curbe-admin    â”‚ default     â”‚ N/A     â”‚ fork    â”‚ 36756    â”‚ 0s     â”‚ 18   â”‚ online    â”‚ 0%       â”‚ 14.0mb   â”‚ root     â”‚ disabled â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
root@ubuntu:/var/www/curbe# sleep 60

root@ubuntu:/var/www/curbe# 
root@ubuntu:/var/www/curbe# pm2 logs curbe-admin --lines 30

[TAILING] Tailing last 30 lines for [curbe-admin] process (change the value with --lines option)
/var/www/curbe/logs/pm2-err.log last 30 lines:
0|curbe-ad | 2025-11-08T02:37:53:     at setupUserModules (node:internal/process/pre_execution:208:5)
0|curbe-ad | 2025-11-08T02:37:53:     at prepareExecution (node:internal/process/pre_execution:161:5)
0|curbe-ad | 2025-11-08T02:37:53:     at prepareMainThreadExecution (node:internal/process/pre_execution:54:10)
0|curbe-ad | 2025-11-08T02:37:53:     at node:internal/main/run_main_module:11:19 {
0|curbe-ad | 2025-11-08T02:37:53:   code: 'MODULE_NOT_FOUND',
0|curbe-ad | 2025-11-08T02:37:53:   requireStack: [ 'internal/preload' ]
0|curbe-ad | 2025-11-08T02:37:53: }
0|curbe-ad | 2025-11-08T02:37:53: 
0|curbe-ad | 2025-11-08T02:37:53: Node.js v20.19.5
0|curbe-ad | 2025-11-08T02:37:53: node:internal/modules/cjs/loader:1210
0|curbe-ad | 2025-11-08T02:37:53:   throw err;
0|curbe-ad | 2025-11-08T02:37:53:   ^
0|curbe-ad | 2025-11-08T02:37:53: 
0|curbe-ad | 2025-11-08T02:37:53: Error: Cannot find module 'dotenv/config'
0|curbe-ad | 2025-11-08T02:37:53: Require stack:
0|curbe-ad | 2025-11-08T02:37:53: - internal/preload
0|curbe-ad | 2025-11-08T02:37:53:     at Module._resolveFilename (node:internal/modules/cjs/loader:1207:15)
0|curbe-ad | 2025-11-08T02:37:53:     at Module._load (node:internal/modules/cjs/loader:1038:27)
0|curbe-ad | 2025-11-08T02:37:53:     at internalRequire (node:internal/modules/cjs/loader:219:19)
0|curbe-ad | 2025-11-08T02:37:53:     at Module._preloadModules (node:internal/modules/cjs/loader:1785:5)
0|curbe-ad | 2025-11-08T02:37:53:     at loadPreloadModules (node:internal/process/pre_execution:747:5)
0|curbe-ad | 2025-11-08T02:37:53:     at setupUserModules (node:internal/process/pre_execution:208:5)
0|curbe-ad | 2025-11-08T02:37:53:     at prepareExecution (node:internal/process/pre_execution:161:5)
0|curbe-ad | 2025-11-08T02:37:53:     at prepareMainThreadExecution (node:internal/process/pre_execution:54:10)
0|curbe-ad | 2025-11-08T02:37:53:     at node:internal/main/run_main_module:11:19 {
0|curbe-ad | 2025-11-08T02:37:53:   code: 'MODULE_NOT_FOUND',
0|curbe-ad | 2025-11-08T02:37:53:   requireStack: [ 'internal/preload' ]
0|curbe-ad | 2025-11-08T02:37:53: }
0|curbe-ad | 2025-11-08T02:37:53: 
0|curbe-ad | 2025-11-08T02:37:53: Node.js v20.19.5

/var/www/curbe/logs/pm2-out.log last 30 lines:
0|curbe-ad | 2025-11-08T02:33:11: 2:33:11 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:33:29: 2:33:29 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:33:29: 2:33:29 AM [express] GET /api/session 401 in 0ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:34:55: Email service initialized successfully
0|curbe-ad | 2025-11-08T02:34:55: Twilio service initialized successfully
0|curbe-ad | 2025-11-08T02:34:55: ==========================================
0|curbe-ad | 2025-11-08T02:34:55: ğŸ”‘ STRIPE INITIALIZED: TEST MODE
0|curbe-ad | 2025-11-08T02:34:55: ğŸ”‘ Key prefix: sk_test_51Rg...
0|curbe-ad | 2025-11-08T02:34:55: ==========================================
0|curbe-ad | 2025-11-08T02:34:55: [WebSocket] Server initialized on path /ws/chat
0|curbe-ad | 2025-11-08T02:34:55: 2:34:55 AM [express] serving on port 5000
0|curbe-ad | 2025-11-08T02:34:55: [REMINDER SCHEDULER] Starting scheduler...
0|curbe-ad | 2025-11-08T02:34:55: [REMINDER SCHEDULER] Scheduler started successfully
0|curbe-ad | 2025-11-08T02:35:25: 2:35:25 AM [express] GET /api/session 401 in 2ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:35:28: [LOGIN-DEBUG] Login attempt for email: claudia@cobertisinsurance.com
0|curbe-ad | 2025-11-08T02:35:28: 2:35:28 AM [express] POST /api/login 400 in 10ms :: {"message":"Invalid request"}
0|curbe-ad | 2025-11-08T02:38:32: Email service initialized successfully
0|curbe-ad | 2025-11-08T02:38:32: Twilio service initialized successfully
0|curbe-ad | 2025-11-08T02:38:32: ==========================================
0|curbe-ad | 2025-11-08T02:38:32: ğŸ”‘ STRIPE INITIALIZED: TEST MODE
0|curbe-ad | 2025-11-08T02:38:32: ğŸ”‘ Key prefix: sk_test_51Rg...
0|curbe-ad | 2025-11-08T02:38:32: ==========================================
0|curbe-ad | 2025-11-08T02:38:32: [WebSocket] Server initialized on path /ws/chat
0|curbe-ad | 2025-11-08T02:38:32: 2:38:32 AM [express] serving on port 5000
0|curbe-ad | 2025-11-08T02:38:32: [REMINDER SCHEDULER] Starting scheduler...
0|curbe-ad | 2025-11-08T02:38:32: [REMINDER SCHEDULER] Scheduler started successfully
0|curbe-ad | 2025-11-08T02:38:33: 2:38:33 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:38:33: 2:38:33 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:38:35: 2:38:35 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-ad | 2025-11-08T02:38:36: 2:38:36 AM [express] GET /api/session 401 in 0ms :: {"message":"Not authenticated"}

0|curbe-admin  | 2025-11-08T02:39:52: 2:39:52 AM [express] GET /api/session 401 in 0ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:39:54: [LOGIN-DEBUG] Login attempt for email: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:39:54: [LOGIN-DEBUG] User found: Yes (ID: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, Status: active, Has Password: true)
0|curbe-admin  | 2025-11-08T02:39:54: [LOGIN-DEBUG] Verifying password for user: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:39:54: [LOGIN-DEBUG] Password valid: true
0|curbe-admin  | 2025-11-08T02:39:54: [LOGIN] 2FA Status - Email: true, SMS: true, Has 2FA: true
0|curbe-admin  | 2025-11-08T02:39:54: [LOGIN] Checking trusted device. Token exists: false, User: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:39:54: âœ“ Session configured for claudia@cobertisinsurance.com. pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:39:54: 2:39:54 AM [express] POST /api/login 200 in 97ms :: {"success":true,"user":{"id":"5fa52b5d-bab3-4d77â€¦
0|curbe-admin  | 2025-11-08T02:39:58: [SEND-OTP] Cookies received: {
0|curbe-admin  | 2025-11-08T02:39:58:   'curbe.sid': 's:mJ9IASgFpGHI20mBCUGndbGrXwDK5Yth.lz7n55gTHPcW2lL8wNE8KsQVw3ud0jKidPd2W3TmwtU',
0|curbe-admin  | 2025-11-08T02:39:58:   __stripe_mid: '0e5c54d8-ad5d-415a-aeac-737d03aeadfe5b8b62',
0|curbe-admin  | 2025-11-08T02:39:58:   __stripe_sid: '859feb54-d2a4-4a4c-844c-eba892bcaea8aa788d',
0|curbe-admin  | 2025-11-08T02:39:58:   'connect.sid': 's:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY'
0|curbe-admin  | 2025-11-08T02:39:58: }
0|curbe-admin  | 2025-11-08T02:39:58: [SEND-OTP] Session ID from cookie: s:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY
0|curbe-admin  | 2025-11-08T02:39:58: [SEND-OTP] Session check - pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:39:58: [EMAIL DEBUG] Starting email send...
0|curbe-admin  | 2025-11-08T02:39:58: [EMAIL DEBUG] From: "Curbe.io" <no-reply@auth.curbe.io>
0|curbe-admin  | 2025-11-08T02:39:58: [EMAIL DEBUG] To: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:39:58: [EMAIL DEBUG] Subject: Your Login Verification Code - Curbe.io
0|curbe-admin  | 2025-11-08T02:39:58: [EMAIL DEBUG] SMTP Config: {
0|curbe-admin  | 2025-11-08T02:39:58:   host: 'mail.curbe.io',
0|curbe-admin  | 2025-11-08T02:39:58:   port: '587',
0|curbe-admin  | 2025-11-08T02:39:58:   user: 'no-reply@auth.curbe.io',
0|curbe-admin  | 2025-11-08T02:39:58:   secure: false
0|curbe-admin  | 2025-11-08T02:39:58: }
0|curbe-admin  | 2025-11-08T02:39:58: Failed to send email - ERROR DETAILS:
0|curbe-admin  | 2025-11-08T02:39:58: Error message: Invalid login: 535 5.7.8 Error: authentication failed: authentication failure
0|curbe-admin  | 2025-11-08T02:39:58: Error code: EAUTH
0|curbe-admin  | 2025-11-08T02:39:58: Error response: 535 5.7.8 Error: authentication failed: authentication failure
0|curbe-admin  | 2025-11-08T02:39:58: Full error: {
0|curbe-admin  | 2025-11-08T02:39:58:   "code": "EAUTH",
0|curbe-admin  | 2025-11-08T02:39:58:   "response": "535 5.7.8 Error: authentication failed: authentication failure",
0|curbe-admin  | 2025-11-08T02:39:58:   "responseCode": 535,
0|curbe-admin  | 2025-11-08T02:39:58:   "command": "AUTH PLAIN"
0|curbe-admin  | 2025-11-08T02:39:58: }
0|curbe-admin  | 2025-11-08T02:39:58: 2:39:58 AM [express] POST /api/auth/send-otp 200 in 138ms :: {"success":true,"message":"Verificationâ€¦
0|curbe-admin  | 2025-11-08T02:40:20: 2:40:20 AM [express] GET /api/session 401 in 3ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:40:20: 2:40:20 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:40:21: [LOGIN-DEBUG] Login attempt for email: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:40:21: [LOGIN-DEBUG] User found: Yes (ID: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, Status: active, Has Password: true)
0|curbe-admin  | 2025-11-08T02:40:21: [LOGIN-DEBUG] Verifying password for user: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:40:21: [LOGIN-DEBUG] Password valid: true
0|curbe-admin  | 2025-11-08T02:40:21: [LOGIN] 2FA Status - Email: true, SMS: true, Has 2FA: true
0|curbe-admin  | 2025-11-08T02:40:21: [LOGIN] Checking trusted device. Token exists: false, User: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:40:21: âœ“ Session configured for claudia@cobertisinsurance.com. pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:40:21: 2:40:21 AM [express] POST /api/login 200 in 83ms :: {"success":true,"user":{"id":"5fa52b5d-bab3-4d77â€¦
0|curbe-admin  | 2025-11-08T02:40:22: [SEND-OTP] Cookies received: {
0|curbe-admin  | 2025-11-08T02:40:22:   'curbe.sid': 's:mJ9IASgFpGHI20mBCUGndbGrXwDK5Yth.lz7n55gTHPcW2lL8wNE8KsQVw3ud0jKidPd2W3TmwtU',
0|curbe-admin  | 2025-11-08T02:40:22:   __stripe_mid: '0e5c54d8-ad5d-415a-aeac-737d03aeadfe5b8b62',
0|curbe-admin  | 2025-11-08T02:40:22:   __stripe_sid: '859feb54-d2a4-4a4c-844c-eba892bcaea8aa788d',
0|curbe-admin  | 2025-11-08T02:40:22:   'connect.sid': 's:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY'
0|curbe-admin  | 2025-11-08T02:40:22: }
0|curbe-admin  | 2025-11-08T02:40:22: [SEND-OTP] Session ID from cookie: s:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY
0|curbe-admin  | 2025-11-08T02:40:22: [SEND-OTP] Session check - pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:40:23: Failed to send SMS: RestException [Error]: The 'StatusCallback' URL http://localhost:5000/api/webhooks/twilio/status is not a valid URL
0|curbe-admin  | 2025-11-08T02:40:23:     at success (/var/www/curbe/node_modules/twilio/lib/base/Version.js:79:23)
0|curbe-admin  | 2025-11-08T02:40:23:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|curbe-admin  | 2025-11-08T02:40:23:     at async TwilioService.sendSMS (file:///var/www/curbe/dist/index.js:10397:22)
0|curbe-admin  | 2025-11-08T02:40:23:     at async TwilioService.sendOTPSMS (file:///var/www/curbe/dist/index.js:10417:7)
0|curbe-admin  | 2025-11-08T02:40:23:     at async file:///var/www/curbe/dist/index.js:12732:9 {
0|curbe-admin  | 2025-11-08T02:40:23:   status: 400,
0|curbe-admin  | 2025-11-08T02:40:23:   code: 21609,
0|curbe-admin  | 2025-11-08T02:40:23:   moreInfo: 'https://www.twilio.com/docs/errors/21609',
0|curbe-admin  | 2025-11-08T02:40:23:   details: undefined
0|curbe-admin  | 2025-11-08T02:40:23: }
0|curbe-admin  | 2025-11-08T02:40:23: 2:40:23 AM [express] POST /api/auth/send-otp 200 in 252ms :: {"success":true,"message":"Verificationâ€¦