root@ubuntu:/var/www/curbe# nano /var/www/curbe/.env
root@ubuntu:/var/www/curbe# pm2 restart curbe-admin
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [curbe-admin](ids: [ 0 ])
[PM2] [curbe-admin](0) âœ“
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name           â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ mem      â”‚ user     â”‚ watching â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ curbe-admin    â”‚ default     â”‚ N/A     â”‚ fork    â”‚ 36873    â”‚ 0s     â”‚ 19   â”‚ online    â”‚ 0%       â”‚ 18.9mb   â”‚ root     â”‚ disabled â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
root@ubuntu:/var/www/curbe# pm2 logs curbe-admin --lines 20

[TAILING] Tailing last 20 lines for [curbe-admin] process (change the value with --lines option)
/var/www/curbe/logs/pm2-err.log last 20 lines:
0|curbe-ad | 2025-11-08T02:39:58: Error message: Invalid login: 535 5.7.8 Error: authentication failed: authentication failure
0|curbe-ad | 2025-11-08T02:39:58: Error code: EAUTH
0|curbe-ad | 2025-11-08T02:39:58: Error response: 535 5.7.8 Error: authentication failed: authentication failure
0|curbe-ad | 2025-11-08T02:39:58: Full error: {
0|curbe-ad | 2025-11-08T02:39:58:   "code": "EAUTH",
0|curbe-ad | 2025-11-08T02:39:58:   "response": "535 5.7.8 Error: authentication failed: authentication failure",
0|curbe-ad | 2025-11-08T02:39:58:   "responseCode": 535,
0|curbe-ad | 2025-11-08T02:39:58:   "command": "AUTH PLAIN"
0|curbe-ad | 2025-11-08T02:39:58: }
0|curbe-ad | 2025-11-08T02:40:23: Failed to send SMS: RestException [Error]: The 'StatusCallback' URL http://localhost:5000/api/webhooks/twilio/status is not a valid URL
0|curbe-ad | 2025-11-08T02:40:23:     at success (/var/www/curbe/node_modules/twilio/lib/base/Version.js:79:23)
0|curbe-ad | 2025-11-08T02:40:23:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|curbe-ad | 2025-11-08T02:40:23:     at async TwilioService.sendSMS (file:///var/www/curbe/dist/index.js:10397:22)
0|curbe-ad | 2025-11-08T02:40:23:     at async TwilioService.sendOTPSMS (file:///var/www/curbe/dist/index.js:10417:7)
0|curbe-ad | 2025-11-08T02:40:23:     at async file:///var/www/curbe/dist/index.js:12732:9 {
0|curbe-ad | 2025-11-08T02:40:23:   status: 400,
0|curbe-ad | 2025-11-08T02:40:23:   code: 21609,
0|curbe-ad | 2025-11-08T02:40:23:   moreInfo: 'https://www.twilio.com/docs/errors/21609',
0|curbe-ad | 2025-11-08T02:40:23:   details: undefined
0|curbe-ad | 2025-11-08T02:40:23: }

/var/www/curbe/logs/pm2-out.log last 20 lines:
0|curbe-ad | 2025-11-08T02:40:21: 2:40:21 AM [express] POST /api/login 200 in 83ms :: {"success":true,"user":{"id":"5fa52b5d-bab3-4d77â€¦
0|curbe-ad | 2025-11-08T02:40:22: [SEND-OTP] Cookies received: {
0|curbe-ad | 2025-11-08T02:40:22:   'curbe.sid': 's:mJ9IASgFpGHI20mBCUGndbGrXwDK5Yth.lz7n55gTHPcW2lL8wNE8KsQVw3ud0jKidPd2W3TmwtU',
0|curbe-ad | 2025-11-08T02:40:22:   __stripe_mid: '0e5c54d8-ad5d-415a-aeac-737d03aeadfe5b8b62',
0|curbe-ad | 2025-11-08T02:40:22:   __stripe_sid: '859feb54-d2a4-4a4c-844c-eba892bcaea8aa788d',
0|curbe-ad | 2025-11-08T02:40:22:   'connect.sid': 's:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY'
0|curbe-ad | 2025-11-08T02:40:22: }
0|curbe-ad | 2025-11-08T02:40:22: [SEND-OTP] Session ID from cookie: s:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY
0|curbe-ad | 2025-11-08T02:40:22: [SEND-OTP] Session check - pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-ad | 2025-11-08T02:40:23: 2:40:23 AM [express] POST /api/auth/send-otp 200 in 252ms :: {"success":true,"message":"Verificationâ€¦
0|curbe-ad | 2025-11-08T02:50:08: Email service initialized successfully
0|curbe-ad | 2025-11-08T02:50:08: Twilio service initialized successfully
0|curbe-ad | 2025-11-08T02:50:08: ==========================================
0|curbe-ad | 2025-11-08T02:50:08: ğŸ”‘ STRIPE INITIALIZED: TEST MODE
0|curbe-ad | 2025-11-08T02:50:08: ğŸ”‘ Key prefix: sk_test_51Rg...
0|curbe-ad | 2025-11-08T02:50:08: ==========================================
0|curbe-ad | 2025-11-08T02:50:08: [WebSocket] Server initialized on path /ws/chat
0|curbe-ad | 2025-11-08T02:50:08: 2:50:08 AM [express] serving on port 5000
0|curbe-ad | 2025-11-08T02:50:08: [REMINDER SCHEDULER] Starting scheduler...
0|curbe-ad | 2025-11-08T02:50:08: [REMINDER SCHEDULER] Scheduler started successfully

0|curbe-admin  | 2025-11-08T02:50:15: 2:50:15 AM [express] GET /api/session 401 in 6ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:50:15: 2:50:15 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:50:17: [LOGIN-DEBUG] Login attempt for email: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:17: [LOGIN-DEBUG] User found: Yes (ID: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, Status: active, Has Password: true)
0|curbe-admin  | 2025-11-08T02:50:17: [LOGIN-DEBUG] Verifying password for user: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:17: [LOGIN-DEBUG] Password valid: true
0|curbe-admin  | 2025-11-08T02:50:17: [LOGIN] 2FA Status - Email: true, SMS: true, Has 2FA: true
0|curbe-admin  | 2025-11-08T02:50:17: [LOGIN] Checking trusted device. Token exists: false, User: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:17: âœ“ Session configured for claudia@cobertisinsurance.com. pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:50:17: 2:50:17 AM [express] POST /api/login 200 in 92ms :: {"success":true,"user":{"id":"5fa52b5d-bab3-4d77â€¦
0|curbe-admin  | 2025-11-08T02:50:19: [SEND-OTP] Cookies received: {
0|curbe-admin  | 2025-11-08T02:50:19:   'curbe.sid': 's:mJ9IASgFpGHI20mBCUGndbGrXwDK5Yth.lz7n55gTHPcW2lL8wNE8KsQVw3ud0jKidPd2W3TmwtU',
0|curbe-admin  | 2025-11-08T02:50:19:   __stripe_mid: '0e5c54d8-ad5d-415a-aeac-737d03aeadfe5b8b62',
0|curbe-admin  | 2025-11-08T02:50:19:   __stripe_sid: '859feb54-d2a4-4a4c-844c-eba892bcaea8aa788d',
0|curbe-admin  | 2025-11-08T02:50:19:   'connect.sid': 's:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY'
0|curbe-admin  | 2025-11-08T02:50:19: }
0|curbe-admin  | 2025-11-08T02:50:19: [SEND-OTP] Session ID from cookie: s:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY
0|curbe-admin  | 2025-11-08T02:50:19: [SEND-OTP] Session check - pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:50:19: [EMAIL DEBUG] Starting email send...
0|curbe-admin  | 2025-11-08T02:50:19: [EMAIL DEBUG] From: "Curbe.io" <no-reply@auth.curbe.io>
0|curbe-admin  | 2025-11-08T02:50:19: [EMAIL DEBUG] To: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:19: [EMAIL DEBUG] Subject: Your Login Verification Code - Curbe.io
0|curbe-admin  | 2025-11-08T02:50:19: [EMAIL DEBUG] SMTP Config: {
0|curbe-admin  | 2025-11-08T02:50:19:   host: 'mail.curbe.io',
0|curbe-admin  | 2025-11-08T02:50:19:   port: '587',
0|curbe-admin  | 2025-11-08T02:50:19:   user: 'no-reply@auth.curbe.io',
0|curbe-admin  | 2025-11-08T02:50:19:   secure: false
0|curbe-admin  | 2025-11-08T02:50:19: }
0|curbe-admin  | 2025-11-08T02:50:19: Failed to send email - ERROR DETAILS:
0|curbe-admin  | 2025-11-08T02:50:19: Error message: Invalid login: 535 5.7.8 Error: authentication failed: authentication failure
0|curbe-admin  | 2025-11-08T02:50:19: Error code: EAUTH
0|curbe-admin  | 2025-11-08T02:50:19: Error response: 535 5.7.8 Error: authentication failed: authentication failure
0|curbe-admin  | 2025-11-08T02:50:19: Full error: {
0|curbe-admin  | 2025-11-08T02:50:19:   "code": "EAUTH",
0|curbe-admin  | 2025-11-08T02:50:19:   "response": "535 5.7.8 Error: authentication failed: authentication failure",
0|curbe-admin  | 2025-11-08T02:50:19:   "responseCode": 535,
0|curbe-admin  | 2025-11-08T02:50:19:   "command": "AUTH PLAIN"
0|curbe-admin  | 2025-11-08T02:50:19: }
0|curbe-admin  | 2025-11-08T02:50:19: 2:50:19 AM [express] POST /api/auth/send-otp 200 in 135ms :: {"success":true,"message":"Verificationâ€¦
0|curbe-admin  | 2025-11-08T02:50:28: 2:50:28 AM [express] GET /api/session 401 in 1ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:50:28: 2:50:28 AM [express] GET /api/session 401 in 2ms :: {"message":"Not authenticated"}
0|curbe-admin  | 2025-11-08T02:50:29: [LOGIN-DEBUG] Login attempt for email: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:29: [LOGIN-DEBUG] User found: Yes (ID: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, Status: active, Has Password: true)
0|curbe-admin  | 2025-11-08T02:50:29: [LOGIN-DEBUG] Verifying password for user: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:29: [LOGIN-DEBUG] Password valid: true
0|curbe-admin  | 2025-11-08T02:50:29: [LOGIN] 2FA Status - Email: true, SMS: true, Has 2FA: true
0|curbe-admin  | 2025-11-08T02:50:29: [LOGIN] Checking trusted device. Token exists: false, User: claudia@cobertisinsurance.com
0|curbe-admin  | 2025-11-08T02:50:29: âœ“ Session configured for claudia@cobertisinsurance.com. pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:50:29: 2:50:29 AM [express] POST /api/login 200 in 85ms :: {"success":true,"user":{"id":"5fa52b5d-bab3-4d77â€¦
0|curbe-admin  | 2025-11-08T02:50:32: [SEND-OTP] Cookies received: {
0|curbe-admin  | 2025-11-08T02:50:32:   'curbe.sid': 's:mJ9IASgFpGHI20mBCUGndbGrXwDK5Yth.lz7n55gTHPcW2lL8wNE8KsQVw3ud0jKidPd2W3TmwtU',
0|curbe-admin  | 2025-11-08T02:50:32:   __stripe_mid: '0e5c54d8-ad5d-415a-aeac-737d03aeadfe5b8b62',
0|curbe-admin  | 2025-11-08T02:50:32:   __stripe_sid: '859feb54-d2a4-4a4c-844c-eba892bcaea8aa788d',
0|curbe-admin  | 2025-11-08T02:50:32:   'connect.sid': 's:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY'
0|curbe-admin  | 2025-11-08T02:50:32: }
0|curbe-admin  | 2025-11-08T02:50:32: [SEND-OTP] Session ID from cookie: s:suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe.XHM1QLFq+XDeaL4/wMZaXuwJeR3oYyPKz6ldvrjpiFY
0|curbe-admin  | 2025-11-08T02:50:32: [SEND-OTP] Session check - pendingUserId: 5fa52b5d-bab3-4d77-b30b-4e9f9832a9ad, sessionID: suEPhcHKMn0dNYI6r9MmiH5YgaArCUHe
0|curbe-admin  | 2025-11-08T02:50:32: Failed to send SMS: RestException [Error]: The 'StatusCallback' URL http://localhost:5000/api/webhooks/twilio/status is not a valid URL
0|curbe-admin  | 2025-11-08T02:50:32:     at success (/var/www/curbe/node_modules/twilio/lib/base/Version.js:79:23)
0|curbe-admin  | 2025-11-08T02:50:32:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|curbe-admin  | 2025-11-08T02:50:32:     at async TwilioService.sendSMS (file:///var/www/curbe/dist/index.js:10397:22)
0|curbe-admin  | 2025-11-08T02:50:32:     at async TwilioService.sendOTPSMS (file:///var/www/curbe/dist/index.js:10417:7)
0|curbe-admin  | 2025-11-08T02:50:32:     at async file:///var/www/curbe/dist/index.js:12732:9 {
0|curbe-admin  | 2025-11-08T02:50:32:   status: 400,
0|curbe-admin  | 2025-11-08T02:50:32:   code: 21609,
0|curbe-admin  | 2025-11-08T02:50:32:   moreInfo: 'https://www.twilio.com/docs/errors/21609',
0|curbe-admin  | 2025-11-08T02:50:32:   details: undefined
0|curbe-admin  | 2025-11-08T02:50:32: }
0|curbe-admin  | 2025-11-08T02:50:32: 2:50:32 AM [express] POST /api/auth/send-otp 200 in 212ms :: {"success":true,"message":"Verificationâ€¦
