Perfecto: con eso ya está clarísimo por qué “no sale el widget”.

**Tu `widget-script.js` que se está sirviendo hoy IGNORA `?code=`** y sigue exigiendo `data-code`. O sea: aunque tú llames

`/widget-script.js?code=...`

el script luego hace:

```js
var widgetCode = currentScript.getAttribute('data-code');
if (!widgetCode) return;
```

Entonces el resultado real en el sitio es:

* Console: **`[CurbeWidget] Missing data-code attribute`**
* No crea el iframe
* No aparece nada

### Lo que tienes que hacer YA (sin negociar con nadie)

Si el embed code que tú diste fue con `?code=...`, tienes 2 opciones:

#### Opción A (más rápida, cambia el snippet en el sitio del cliente)

Pon esto y listo:

```html
<script defer src="https://app.curbe.io/widget-script.js" data-code="42003b93-3945-498c-bc93-81184b143c4f"></script>
```

Eso hace que el script encuentre el código y cree el iframe.

#### Opción B (la correcta a nivel producto: soporte a ambos formatos)

Arregla **el archivo que se sirve en** `/widget-script.js` para que soporte `data-code` **y** `?code=`.

Aquí tienes el **patch exacto** (esto reemplaza tu bloque de “get widget code” y ya):

```js
// Find the script tag (prefer document.currentScript)
var currentScript = document.currentScript;

if (!currentScript) {
  var scripts = document.getElementsByTagName('script');
  for (var i = scripts.length - 1; i >= 0; i--) {
    if (scripts[i].src && scripts[i].src.indexOf('widget-script.js') !== -1) {
      currentScript = scripts[i];
      break;
    }
  }
}

if (!currentScript) {
  console.error('[CurbeWidget] Could not find widget script tag');
  return;
}

// Read code from data-code OR from ?code= in the script src
var widgetCode = currentScript.getAttribute('data-code');

if (!widgetCode) {
  try {
    widgetCode = new URL(currentScript.src).searchParams.get('code');
  } catch (e) {
    widgetCode = null;
  }
}

if (!widgetCode) {
  console.error('[CurbeWidget] Missing widget code (data-code or ?code=)');
  return;
}
```

### Importante (porque aquí te puede seguir “no saliendo” aunque arregles lo anterior)

Después de que ya cree el iframe, el widget depende de que esta URL cargue bien:

`https://app.curbe.io/widget/<code>`

Si esa ruta devuelve **302 a login**, **403**, o tiene `X-Frame-Options: SAMEORIGIN/DENY`, el iframe no renderiza y tú creerás que “no sale”.

### Cómo lo verificas en 15 segundos

1. En el sitio del cliente, DevTools → Console: ¿sale “Missing data-code”?
2. DevTools → Elements: ¿existe `#curbe-widget-iframe`?
3. Abre directo en browser: `https://app.curbe.io/widget/42003b93-...`

   * Si no carga público y bien, el embed está condenado.

Lo brutalmente honesto: ahora mismo tu producto está rompiéndose por una tontería de contrato (`data-code` vs `?code`). Eso no es “camino sin salida”, es “falta de compatibilidad básica”. Arregla esto y por fin podrás atacar los problemas reales (auth, headers, postMessage, UI).
